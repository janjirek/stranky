---
import Layout from '@/layouts/Layout.astro';
import Hero from './hero.astro';
import { getCollection } from 'astro:content';
import BlogPosts from '@/components/blog-posts';
import { getCldImageUrl } from 'astro-cloudinary/helpers';

export const metadata = {
  title: 'Ing. Jan Jírek - Články',
  description: 'Ing. Jan Jírek - Články o nemovitostech',
};

const blog = (await getCollection('blog')).sort((a, b) => {
  return b.data.date.valueOf() - a.data.date.valueOf();
});
const blogWithThumbnail = blog.map((entry: any) => {
  if (entry.data.thumbnail) {
    return {
      ...entry,
      thumbnail_url: entry.data.thumbnail_local
        ? `${entry.data.slug}/${entry.data.thumbnail_local}`
        : getCldImageUrl({ src: entry.data.thumbnail, width: 600, height: 400 }),
    };
  }
  return entry;
});
---

<Layout title="Ing. Jan Jírek - Články" description="Ing. Jan Jírek - Články o nemovitostech">
  <Hero />
  <div class="mx-auto max-w-6xl px-4 sm:px-6">
    <BlogPosts posts={blogWithThumbnail} postsPerPage={3} client:load />
  </div>
</Layout>

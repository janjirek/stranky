---
import EstateItem from './estate-item.astro';
import { getCollection } from 'astro:content';

// Předpokládáme, že kolekce se jmenuje 'catalogue'
const entries = (await getCollection('catalogue')).sort((a, b) => {
  // Řadit od nejnovějšího
  return b.data.date.valueOf() - a.data.date.valueOf();
});

const estates = entries.map(entry => {
  return {
    ...entry.data,
    slug: entry.slug, // Zde přidáváme slug, aby fungoval odkaz v EstateItem
  };
});
---

<section class="py-12 md:py-20 bg-slate-50 dark:bg-slate-900">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    
    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {estates.map(estate => (
        <EstateItem estate={estate} isHidden={false} />
      ))}
    </div>

    {estates.length === 0 && (
      <div class="text-center py-20 bg-white dark:bg-slate-800 rounded-3xl shadow-xl border border-slate-100 dark:border-slate-700">
        <p class="text-xl font-medium text-slate-600 dark:text-slate-300">
          Momentálně nemám v nabídce žádné nemovitosti.
        </p>
        <p class="mt-4 text-slate-500 dark:text-slate-400">
          Neváhejte mě kontaktovat s vaší poptávkou, rád pro vás najdu ideální bydlení.
        </p>
      </div>
    )}

  </div>
</section>